<!doctype html>
<html>
<head>
<script>
var list={MinecraftPE游戏地图:[{name:"",id:0}],Flash:[{name:"Traps N' Roads",id:1}],Mobile:[{name:"Crasher",id:5}],Desktop:[{name:"Edgar Su",id:2},{name:"Queue Huo",id:3},{name:"Alan Liang",id:4}]};
</script>
<!--google stylesheets-->
<link href="/gs.css" rel="stylesheet" type="text/css" />
<link href="/mdc.css" rel="stylesheet" type="text/css" />
<link href="/mdc-patch.css" rel="stylesheet" type="text/css" />

<link href="/styles.css" rel="stylesheet" type="text/css" />

<meta charset="utf-8">
<title>客页 | KEEER</title>

<script language="x/templ" id="templ">
  <li class="mdc-list-item mdc-list-i prod" data-id="{{id}}" data-mdc-auto-init="MDCRipple" id="prod{{id}}">{{name}}</li>
</script>
<script language="x/templ" id="btn">
<div role="button">
	<div style="top: 19px; left: 54px; width: 48px; height: 48px;"><img src="/icons/more.svg" class="icon"></div>
</div>
</script>

</head>

<body>
<div id="main" style="display:none;">
<div class="header" id="header">
	<span class="htext">客页 | KEEER</span>
    <span class="nav">
    	<a href="/about.html">关于我们</a>
        <a href="/products/">项目列表</a>
        <a href="/contact.html">联系我们</a>
        <a href="/en/">English</a>
    </span>
</div>
<div class="title">
	<div class="content">
		客页工作室<br />
		我们的独立游戏
	</div>
</div>
<div class="main">
	<div class="content">
        <div class="header active">
            <span class="htext">最新项目</span>
            <button class="nav green" id="blistall">查看全部></button>
        </div>
        <hr />
        <ul>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
            <li>Lorum ipsum</li>
        </ul>
        <div style="text-align:center;"><button class="nav green" id="blist">项目列表</button></div>
    </div>
</div>
<div class="footer">
	<div class="content">
    	<a class="about" href="/about.html">关于我们</a>
        <a class="plist_link" href="/products/">项目列表</a>
        <a class="contact-us" href="/contact.html">联系我们</a>
    </div>
    <a href="https://www.keeer.cf/"><img class="logo" src="/logo.png" /></a>
</div>
</div>

<div id="pcontainer" style="display:block;">
<div id="plist" style="left:0;">
<header class="mdc-toolbar">
  <div class="mdc-toolbar__row">
	<div class="hi">
		<div role="button" id="back">
			<div style="top: 19px; left: 54px; width: 48px; height: 48px;"><img src="/icons/back.svg" class="icon" /></div>
		</div>
	</div>
    <section class="mdc-toolbar__section">
      <span class="mdc-toolbar__title">项目列表 | 客页</span>
    </section>
    <div class="hi">
   		<div role="button" style="cursor:default">
		</div>
    </div>
  </div>
</header>

<ul class="mdc-list" id="p-list">
</ul>

</div>


<div id="pitem">
<header class="mdc-toolbar">
  <div class="mdc-toolbar__row">
	<div class="hi">
		<div role="button" id="close">
			<div style="top: 19px; left: 54px; width: 48px; height: 48px;"><img src="/icons/close.svg" class="icon" /></div>
		</div>
	</div>
    <section class="mdc-toolbar__section">
      <span class="mdc-toolbar__title">项目 | 客页</span>
    </section>
    <div class="hi">
   		<div role="button" style="cursor:default">
		</div>
    </div>
  </div>
</header>

<div id="pitext"></div>
</div>
</div>


<!-- scripts -->
<script src="/utils.js"></script>
<script src="/pjax.js"></script>
<script>
var header=$("header");
window.onscroll=function(e){
	if(window.pageYOffset>=400-64){
		header.classList.add("active");
	}else{
		header.classList.remove("active");
	}
};
</script>
<script>
pjax.pagecount=0;
pjax.pages=[];
var listeners={};
listeners.main=function(){
	animate(plist,{duration:200,left:window.innerWidth+16},"left");
	main.style.display="block";
	setTimeout(function(){pcontainer.style.display="none";},200);
	window.onresize=winresize;
	window.issubopened=false;
	return;
};
listeners.list=function(){
	if(window.issubopened){
		setTimeout(function(){window.issubopened=false;},200);
		window.issubpened="animating";
		animate(pitem,{duration:200,left:window.innerWidth},"left");
		animate(plist,{duration:200,right:0},"right");
		return;
	}else{
		pcontainer.style.display="block";
		animate(plist,{duration:200,left:0},"left");
		setTimeout(function(){main.style.display="none";},200);
		window.onresize=null;
		return;
	}
};
listeners.subpage=function(){
	var id=getParam("id");
	if(window.issubopened==true){
		animate(pitem,{duration:200,left:window.innerWidth},"left");
		animate(plist,{duration:200,right:0},"right");
	}
	var callback=function(msg){
		if(msg==-1){
			alert("对不起，此项目不存在，请通知管理员，谢谢");
			history.go(-1);
			return;
		}
		if(window.issubopened){
			setTimeout(function(){
				pitext.innerHTML = msg;
				animate(pitem,{duration:200,left:400},"left");
				animate(plist,{duration:200,right:window.innerWidth-416},"right");
			},200);
			if(window.issubopened=="animating")
				setTimeout(function(){window.issubopened=true;},200);
		}else{
			window.issubopened=true;
			pitext.innerHTML = msg;
			pitem.style.display="block";
			animate(pitem,{duration:200,left:400},"left");
			animate(plist,{duration:200,right:window.innerWidth-416},"right");
		}
	};
	getSubData(id,callback);
	return;
};
var pages={};
(function(titles,urls){
	for(var i in listeners){
		if(i=="subpage"){
			pages[i]=[];
			for(var o in list){
				for(var j=0;j<list[o].length;j++){
					pages[i][list[o][j].id]=new pjax.page(
						list[o][j].name+" | 项目 | 客页",
						"/products/view.html?id="+list[o][j].id,
						listeners[i]
					);
				}
			}
			return;
		}
		pages[i]=new pjax.page(
			titles[i],
			urls[i],
			listeners[i]
		);
	}
})({"main":"客页 | KEEER",
	"list":"项目 | 客页"
	},
	{"main":"/",
	"list":"/products/"
});
pjax.history=[pjax.pages[1]];

var plist=$("plist");
function winresize(){
	plist.style.left = window.innerWidth+16+"px";
	pitem.style.left = window.innerWidth+16+"px";
}

var blist=$("blist");
var blistall=$("blistall");
var main=$("main");
var pcontainer=$("pcontainer");
var pitem=$("pitem");
var pitext=$("pitext");
blistall.onclick=blist.onclick=function(e){
	pjax.push(pages.list);
};

var backbtn=$("back");
backbtn.onclick=function(){
	pjax.push(pages.main);
};
var templ=document.getElementById("templ").innerHTML;
var p_list=$("p-list");
var btnhtml=$("btn").innerHTML;
for(var i in list){
	var newdiv;
	newdiv=document.createElement("div");
	newdiv.className="p-type p-closed";
	newdiv.innerHTML=template(templ,{name:btnhtml+i,id:"Type"+i});
	p_list.appendChild(newdiv);
	for(var j=0;j<list[i].length;j++){
		newdiv.innerHTML+=template(templ,list[i][j]);
	}
	var btn=newdiv.querySelector("li");
	btn.onclick=function(e){
		if(e.currentTarget.parentElement.classList.contains("p-closed")){
			e.currentTarget.parentElement.classList.remove("p-closed");
			e.currentTarget.querySelector("img").classList.add("less");
		}
		else{
			e.currentTarget.parentElement.classList.add("p-closed");
			e.currentTarget.querySelector("img").classList.remove("less");
		}
	};
}
function getSubData(id,callback){
	httpget("/products/"+id+"/product.html",function(status,response){
		if(status==404)callback(-1);
		if(status==200)callback(response);
	});
}
var closebtn=$("close");
closebtn.onclick=function(){
	pjax.push(pages.list);
};
var subListener = function(e){
	var id=e.currentTarget.getAttribute("data-id");
	var exec=function(){
		pjax.push(pages.subpage[parseInt(id)]);
		window.issubopened=true;
	};
	if(window.issubopened){
		pjax.push(pages.list);
		setTimeout(exec,201);
		return;
	}
	exec();
};
var listitems=p_list.querySelectorAll(".p-type>li+li");
for(var i=0;i<listitems.length;i++){
	listitems[i].onclick=subListener;
}
</script>
<script src="/mdc.js"></script>
<script>mdc.autoInit()</script>

</body>
</html>
